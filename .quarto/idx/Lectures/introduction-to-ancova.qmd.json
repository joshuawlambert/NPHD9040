{"title":"Introduction to ANCOVA","markdown":{"yaml":{"title":"Introduction to ANCOVA","author":"Dr. Joshua Lambert","output":"html","format":{"html":{"toc":true,"toc-title":"Table of Contents","code-fold":false,"code-tools":true}}},"headingText":"Understanding Hypothesis Testing and ANCOVA","containsRefs":false,"markdown":"\n\n[**Download R Code for this Lecture**](code/introduction-to-ancova.R){ .btn .btn-primary }\n\n\n\n\n### Definition and Purpose of ANCOVA\n\nAnalysis of Covariance (ANCOVA) is a statistical method that combines [ANOVA](introduction-to-anova.qmd) and regression. It assesses the main and interaction effects of categorical variables on a continuous outcome while controlling for the influence of one or more continuous covariates.\n\n### Key Differences Between ANCOVA and ANOVA\n\n1.  **ANOVA** examines differences in means between groups without adjusting for other variables.\n2.  **ANCOVA** adjusts group means to account for the effect of covariates.\n\n### Assumptions of ANCOVA\n\n1.  The dependent variable is measured on an interval or ratio scale.\n2.  The independent variable is categorical.\n3.  Covariates are measured on an interval or ratio scale.\n4.  Random sampling.\n5.  Normal distribution of the dependent variable.\n6.  Homogeneity of variance.\n7.  Homogeneity of regression slopes between groups.\n\n### Independent Variables and Covariates\n\n-   **Independent Variables:** Categorical factors of interest.\n-   **Covariates:** Continuous variables used to adjust the dependent variable.\n\n### Visualizing ANCOVA\n\nVisualizing ANCOVA often involves making line plots to show the trajectory of the independent variable (x-axis) and dependent variable (y-axis) by group (color). One of the assumptions of an ANCOVA is \"Homogeneity of regression slopes between groups\". As we can see in this graph, there doesn't seem to be graphical evidence for that. Use scatter plots to visualize the relationship between the predictor\nand outcome variables. For more on creating these visualizations in R, see the [Graphing Your Data](graphing-your-data.qmd) lecture.\n\n```{r, echo=FALSE, message=FALSE}\n    # Example visualization in R\n        library(ggplot2)\n        set.seed(123)\n        data <- data.frame(\n          group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n          pre_stress = rnorm(30, 5, 1),\n          post_stress = c(rnorm(10, 5, 1), rnorm(10, 7, 1), rnorm(10, 6, 1))\n        )\n\n        # Interaction plot\n        ggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n          geom_point() +\n          geom_smooth(method = \"lm\", se = FALSE) +\n          labs(title = \"Interaction Plot\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n      \n```\n\nAs we can see here, this example shows slopes that are much more similar. Thats good because if we are going to use ANCOVA, we are assuming they are the *same* or atleast very similar.\n\n```{r, echo=FALSE, message=FALSE}\n# Example visualization in R with same slopes\nlibrary(ggplot2)\nset.seed(123)\n\n# Generate pre_stress values\npre_stress <- rnorm(30, 5, 1)\n\n# Common linear equation for all groups\ncommon_slope <- 0.8  # Choose a common slope\nintercept <- 1       # Choose a common intercept\n\n# Calculate post_stress using the common linear equation\npost_stress <- pre_stress * common_slope + intercept + rnorm(30, 0, 1)\n\n# Create the data frame\ndata <- data.frame(\n  group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n  pre_stress = pre_stress,\n  post_stress = post_stress\n)\n\n# Interaction plot with same slopes\nggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Interaction Plot with Same Slopes\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n\n```\n\n```{r, eval=FALSE}\n# Example visualization in R\n        library(ggplot2)\n\n        data <- data.frame(\n          group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n          pre_stress = rnorm(30, 5, 1),\n          post_stress = c(rnorm(10, 5, 1), rnorm(10, 7, 1), rnorm(10, 6, 1))\n        )\n\n        # Interaction plot\n        ggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n          geom_point() +\n          geom_smooth(method = \"lm\", se = FALSE) +\n          labs(title = \"Interaction Plot\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n```\n\n### Calculation of Adjusted Means\n\nAdjusted means, or least-squares means, are averages that account for the influence of covariates. They are particularly useful in analyses like ANCOVA to provide unbiased comparisons across groups by removing the effects of nuisance variables. This adjustment ensures that the differences between groups reflect the effect of the primary variables of interest, not the covariates. Thus, adjusted means enable a fair comparison of group differences after controlling for external influences.\n\n```{r, eval=FALSE}\n# Adjusted means in R\n        library(car)\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        Anova(model, type = 3)\n        lsmeans <- emmeans::emmeans(model, \"group\")\n        print(lsmeans)\n```\n\n### Testing Main Effects and Investigating the Interaction\n\nTesting main effects reveals the individual impact of each independent and covariate variable on the outcome. Investigating interaction effects uncovers how combinations of these variables jointly influence the outcome. Together, they provide a comprehensive understanding of the relationships within the data, guiding more accurate interpretations and conclusions about our ANCOVA result.\n\n1.  **Main Effects:** The impact of each independent and covariate variable on the outcome.\n2.  **Interaction Effects:** How combinations of independent and covariate variables influence the outcome.\n\n```{r, eval=FALSE}\n# Testing main effects and interaction in R\n        model <- lm(post_stress ~ group * pre_stress, data = data)\n        Anova(model, type = 3)\n```\n\n### Effect Sizes and Significance, F Test, SSC, SSB, SSW, P-value\n\n-   **F Test:** Determines if group means are significantly different.\n-   **SSB (Sum of Squares Between):** Measures variation between groups.\n-   **SSC (Sum of Squares Covariate):** Measures the variation explained by the covariate.\n-   **SSW (Sum of Squares Within):** Measures variation within groups.\n-   **P-value:** Indicates statistical significance.\n\n```{r, eval=FALSE}\n# Effect sizes and significance in R\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        Anova(model, type = 3)\n```\n\n### Examples of ANCOVA in Nursing Research\n\n1.  **Patient Recovery Rates:** Comparing patient recovery rates across different treatment groups while controlling for age and baseline health status.\n2.  **Stress Reduction Programs:** Evaluating the effectiveness of stress reduction programs while controlling for initial stress levels.\n\n### Hands-on Example: Interpreting Your Results\n\n<a href=\"ancova_ex1.csv\" download>download ex. 1 data (CSV)</a>\n\n```{r, eval=FALSE}\n# Example ANCOVA in R\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        summary(model)\n        Anova(model, type = 3)\n```\n\n","srcMarkdownNoYaml":"\n\n[**Download R Code for this Lecture**](code/introduction-to-ancova.R){ .btn .btn-primary }\n\n\n\n# Understanding Hypothesis Testing and ANCOVA\n\n### Definition and Purpose of ANCOVA\n\nAnalysis of Covariance (ANCOVA) is a statistical method that combines [ANOVA](introduction-to-anova.qmd) and regression. It assesses the main and interaction effects of categorical variables on a continuous outcome while controlling for the influence of one or more continuous covariates.\n\n### Key Differences Between ANCOVA and ANOVA\n\n1.  **ANOVA** examines differences in means between groups without adjusting for other variables.\n2.  **ANCOVA** adjusts group means to account for the effect of covariates.\n\n### Assumptions of ANCOVA\n\n1.  The dependent variable is measured on an interval or ratio scale.\n2.  The independent variable is categorical.\n3.  Covariates are measured on an interval or ratio scale.\n4.  Random sampling.\n5.  Normal distribution of the dependent variable.\n6.  Homogeneity of variance.\n7.  Homogeneity of regression slopes between groups.\n\n### Independent Variables and Covariates\n\n-   **Independent Variables:** Categorical factors of interest.\n-   **Covariates:** Continuous variables used to adjust the dependent variable.\n\n### Visualizing ANCOVA\n\nVisualizing ANCOVA often involves making line plots to show the trajectory of the independent variable (x-axis) and dependent variable (y-axis) by group (color). One of the assumptions of an ANCOVA is \"Homogeneity of regression slopes between groups\". As we can see in this graph, there doesn't seem to be graphical evidence for that. Use scatter plots to visualize the relationship between the predictor\nand outcome variables. For more on creating these visualizations in R, see the [Graphing Your Data](graphing-your-data.qmd) lecture.\n\n```{r, echo=FALSE, message=FALSE}\n    # Example visualization in R\n        library(ggplot2)\n        set.seed(123)\n        data <- data.frame(\n          group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n          pre_stress = rnorm(30, 5, 1),\n          post_stress = c(rnorm(10, 5, 1), rnorm(10, 7, 1), rnorm(10, 6, 1))\n        )\n\n        # Interaction plot\n        ggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n          geom_point() +\n          geom_smooth(method = \"lm\", se = FALSE) +\n          labs(title = \"Interaction Plot\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n      \n```\n\nAs we can see here, this example shows slopes that are much more similar. Thats good because if we are going to use ANCOVA, we are assuming they are the *same* or atleast very similar.\n\n```{r, echo=FALSE, message=FALSE}\n# Example visualization in R with same slopes\nlibrary(ggplot2)\nset.seed(123)\n\n# Generate pre_stress values\npre_stress <- rnorm(30, 5, 1)\n\n# Common linear equation for all groups\ncommon_slope <- 0.8  # Choose a common slope\nintercept <- 1       # Choose a common intercept\n\n# Calculate post_stress using the common linear equation\npost_stress <- pre_stress * common_slope + intercept + rnorm(30, 0, 1)\n\n# Create the data frame\ndata <- data.frame(\n  group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n  pre_stress = pre_stress,\n  post_stress = post_stress\n)\n\n# Interaction plot with same slopes\nggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Interaction Plot with Same Slopes\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n\n```\n\n```{r, eval=FALSE}\n# Example visualization in R\n        library(ggplot2)\n\n        data <- data.frame(\n          group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n          pre_stress = rnorm(30, 5, 1),\n          post_stress = c(rnorm(10, 5, 1), rnorm(10, 7, 1), rnorm(10, 6, 1))\n        )\n\n        # Interaction plot\n        ggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n          geom_point() +\n          geom_smooth(method = \"lm\", se = FALSE) +\n          labs(title = \"Interaction Plot\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n```\n\n### Calculation of Adjusted Means\n\nAdjusted means, or least-squares means, are averages that account for the influence of covariates. They are particularly useful in analyses like ANCOVA to provide unbiased comparisons across groups by removing the effects of nuisance variables. This adjustment ensures that the differences between groups reflect the effect of the primary variables of interest, not the covariates. Thus, adjusted means enable a fair comparison of group differences after controlling for external influences.\n\n```{r, eval=FALSE}\n# Adjusted means in R\n        library(car)\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        Anova(model, type = 3)\n        lsmeans <- emmeans::emmeans(model, \"group\")\n        print(lsmeans)\n```\n\n### Testing Main Effects and Investigating the Interaction\n\nTesting main effects reveals the individual impact of each independent and covariate variable on the outcome. Investigating interaction effects uncovers how combinations of these variables jointly influence the outcome. Together, they provide a comprehensive understanding of the relationships within the data, guiding more accurate interpretations and conclusions about our ANCOVA result.\n\n1.  **Main Effects:** The impact of each independent and covariate variable on the outcome.\n2.  **Interaction Effects:** How combinations of independent and covariate variables influence the outcome.\n\n```{r, eval=FALSE}\n# Testing main effects and interaction in R\n        model <- lm(post_stress ~ group * pre_stress, data = data)\n        Anova(model, type = 3)\n```\n\n### Effect Sizes and Significance, F Test, SSC, SSB, SSW, P-value\n\n-   **F Test:** Determines if group means are significantly different.\n-   **SSB (Sum of Squares Between):** Measures variation between groups.\n-   **SSC (Sum of Squares Covariate):** Measures the variation explained by the covariate.\n-   **SSW (Sum of Squares Within):** Measures variation within groups.\n-   **P-value:** Indicates statistical significance.\n\n```{r, eval=FALSE}\n# Effect sizes and significance in R\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        Anova(model, type = 3)\n```\n\n### Examples of ANCOVA in Nursing Research\n\n1.  **Patient Recovery Rates:** Comparing patient recovery rates across different treatment groups while controlling for age and baseline health status.\n2.  **Stress Reduction Programs:** Evaluating the effectiveness of stress reduction programs while controlling for initial stress levels.\n\n### Hands-on Example: Interpreting Your Results\n\n<a href=\"ancova_ex1.csv\" download>download ex. 1 data (CSV)</a>\n\n```{r, eval=FALSE}\n# Example ANCOVA in R\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        summary(model)\n        Anova(model, type = 3)\n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"columns":12,"css":["../styles.css"],"output-file":"introduction-to-ancova.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.26","theme":"journal","title":"Introduction to ANCOVA","author":"Dr. Joshua Lambert","toc-title":"Table of Contents"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}