{
  "hash": "b32574c151693d3c43f6f8984b724e85",
  "result": {
    "markdown": "---\ntitle: \"Introduction to ANCOVA\"\nauthor: \"Dr. Joshua Lambert\"\noutput: html\nformat:\n  html:\n    toc: true\n    toc-title: \"Table of Contents\"\n    code-fold: true\n    code-tools: true\n---\n\n\n# Understanding Hypothesis Testing and ANCOVA\n\n### Definition and Purpose of ANCOVA\n\nAnalysis of Covariance (ANCOVA) is a statistical method that combines ANOVA and regression. It assesses the main and interaction effects of categorical variables on a continuous outcome while controlling for the influence of one or more continuous covariates.\n\n### Key Differences Between ANCOVA and ANOVA\n\n1.  **ANOVA** examines differences in means between groups without adjusting for other variables.\n2.  **ANCOVA** adjusts group means to account for the effect of covariates.\n\n### Assumptions of ANCOVA\n\n1.  The dependent variable is measured on an interval or ratio scale.\n2.  The independent variable is categorical.\n3.  Covariates are measured on an interval or ratio scale.\n4.  Random sampling.\n5.  Normal distribution of the dependent variable.\n6.  Homogeneity of variance.\n7.  Homogeneity of regression slopes between groups.\n\n### Independent Variables and Covariates\n\n-   **Independent Variables:** Categorical factors of interest.\n-   **Covariates:** Continuous variables used to adjust the dependent variable.\n\n### Visualizing ANCOVA\n\nVisualizing ANCOVA often involves making line plots to show the trajectory of the independent variable (x-axis) and dependent variable (y-axis) by group (color). One of the assumptions of an ANCOVA is \"Homogeneity of regression slopes between groups\". As we can see in this graph, there doesn't seem to be graphical evidence for that.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](introduction-to-ancova_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nAs we can see here, this example shows slopes that are much more similar. Thats good because if we are going to use ANCOVA, we are assuming they are the *same* or atleast very similar.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](introduction-to-ancova_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n<details>\n\n<summary>JMP Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>Fit Model</code>.</li>\n\n<li>Select your categorical variable as the Model Effects and covariate as Continuous.</li>\n\n<li>Click <code>RUN</code>.</li>\n\n<li>Click the red triangle and choose <code>Least Squares Fit</code> to visualize.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>R Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Example visualization in R\n        library(ggplot2)\n\n        data <- data.frame(\n          group = rep(c(\"Placebo\", \"Behavioral\", \"Drug\"), each = 10),\n          pre_stress = rnorm(30, 5, 1),\n          post_stress = c(rnorm(10, 5, 1), rnorm(10, 7, 1), rnorm(10, 6, 1))\n        )\n\n        # Interaction plot\n        ggplot(data, aes(x = pre_stress, y = post_stress, color = group)) +\n          geom_point() +\n          geom_smooth(method = \"lm\", se = FALSE) +\n          labs(title = \"Interaction Plot\", x = \"Pre-Stress Score\", y = \"Post-Stress Score\")\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Python Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n# Example visualization in Python\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\n\n# Generate data\ndata = pd.DataFrame({\n\"group\": np.repeat([\"Placebo\", \"Behavioral\", \"Drug\"], 10),\n\"pre_stress\": np.random.normal(5, 1, 30),\n\"post_stress\": np.concatenate([np.random.normal(5, 1, 10),\nnp.random.normal(7, 1, 10),\nnp.random.normal(6, 1, 10)])\n        })\n\n# Interaction plot\nsns.lmplot(x=\"pre_stress\", y=\"post_stress\", hue=\"group\", data=data, ci=None)\nplt.title(\"Interaction Plot\")\nplt.xlabel(\"Pre-Stress Score\")\nplt.ylabel(\"Post-Stress Score\")\nplt.show()\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>SPSS Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>General Linear Model</code> \\> <code>Univariate</code>.</li>\n\n<li>Select your categorical variable as the Fixed Factor and the covariate as Covariate.</li>\n\n<li>Click <code>Plots</code> to visualize the interaction.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Stata Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        // Example visualization in Stata\n        sysuse auto, clear\n        scatter mpg weight, by(foreign)\n        twoway lfitci mpg weight if foreign == 0, addplot(lfitci mpg weight if foreign == 1)\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n### Calculation of Adjusted Means\n\nAdjusted means, or least-squares means, are averages that account for the influence of covariates. They are particularly useful in analyses like ANCOVA to provide unbiased comparisons across groups by removing the effects of nuisance variables. This adjustment ensures that the differences between groups reflect the effect of the primary variables of interest, not the covariates. Thus, adjusted means enable a fair comparison of group differences after controlling for external influences.\n\n<details>\n\n<summary>JMP Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>Fit Model</code>.</li>\n\n<li>Select your categorical variable as the Model Effects and covariate as Continuous.</li>\n\n<li>Click <code>OK</code>.</li>\n\n<li>Click the red triangle on right side and choose <code>LSMeans Plot</code>.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>R Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Adjusted means in R\n        library(car)\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        Anova(model, type = 3)\n        lsmeans <- emmeans::emmeans(model, \"group\")\n        print(lsmeans)\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Python Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n# Adjusted means in Python\nimport statsmodels.api as sm\nfrom statsmodels.formula.api import ols\nimport statsmodels.stats.anova as anova\n\n# ANCOVA model\nmodel = ols('post_stress ~ group + pre_stress', data=data).fit()\nprint(anova.anova_lm(model, typ=3))\n\n# Adjusted means\nimport statsmodels.stats.multicomp as mc\nmeans = mc.pairwise_tukeyhsd(model.predict(), data['group'])\nprint(means)\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>SPSS Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>General Linear Model</code> \\> <code>Univariate</code>.</li>\n\n<li>Select your categorical variable as the Fixed Factor and the covariate as Covariate.</li>\n\n<li>Click <code>EMMeans</code> and select your categorical variable.</li>\n\n<li>Click <code>Continue</code> and <code>OK</code> to generate adjusted means.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Stata Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        // Adjusted means in Stata\n        sysuse auto, clear\n        anova mpg foreign weight\n        margins foreign, at(weight=(2000 3000 4000))\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n### Testing Main Effects and Investigating the Interaction\n\nTesting main effects reveals the individual impact of each independent and covariate variable on the outcome. Investigating interaction effects uncovers how combinations of these variables jointly influence the outcome. Together, they provide a comprehensive understanding of the relationships within the data, guiding more accurate interpretations and conclusions about our ANCOVA result.\n\n1.  **Main Effects:** The impact of each independent and covariate variable on the outcome.\n2.  **Interaction Effects:** How combinations of independent and covariate variables influence the outcome.\n\n<details>\n\n<summary>JMP Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>Fit Model</code>.</li>\n\n<li>Select your categorical variable as the Model Effects and covariate as Continuous.</li>\n\n<li>Click <code>OK</code>.</li>\n\n<li>Click the red triangle and choose <code>LSMeans Plot</code> and <code>Interaction Plot</code>.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>R Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Testing main effects and interaction in R\n        model <- lm(post_stress ~ group * pre_stress, data = data)\n        Anova(model, type = 3)\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Python Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Testing main effects and interaction in Python\n        model = ols('post_stress ~ group * pre_stress', data=data).fit()\n        print(anova.anova_lm(model, typ=3))\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>SPSS Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>General Linear Model</code> \\> <code>Univariate</code>.</li>\n\n<li>Select your categorical variable as the Fixed Factor and the covariate as Covariate.</li>\n\n<li>Click <code>Plots</code> to generate an Interaction Plot.</li>\n\n<li>Click <code>OK</code> to view the results.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Stata Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        // Testing main effects and interaction in Stata\n        sysuse auto, clear\n        anova mpg foreign weight foreign#weight\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n### Effect Sizes and Significance, F Test, SSC, SSB, SSW, P-value\n\n-   **F Test:** Determines if group means are significantly different.\n-   **SSB (Sum of Squares Between):** Measures variation between groups.\n-   **SSC (Sum of Squares Covariate):** Measures the variation explained by the covariate.\n-   **SSW (Sum of Squares Within):** Measures variation within groups.\n-   **P-value:** Indicates statistical significance.\n\n<details>\n\n<summary>JMP Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>Fit Model</code>.</li>\n\n<li>Select your categorical variable as the Model Effects and covariate as Continuous.</li>\n\n<li>Click <code>OK</code>.</li>\n\n<li>Click the red triangle and choose <code>Effect Tests</code>.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>R Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Effect sizes and significance in R\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        Anova(model, type = 3)\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Python Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Effect sizes and significance in Python\n        model = ols('post_stress ~ group + pre_stress', data=data).fit()\n        print(anova.anova_lm(model, typ=3))\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>SPSS Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>General Linear Model</code> \\> <code>Univariate</code>.</li>\n\n<li>Select your categorical variable as the Fixed Factor and the covariate as Covariate.</li>\n\n<li>Click <code>OK</code> to view the results.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Stata Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        // Effect sizes and significance in Stata\n        sysuse auto, clear\n        anova mpg foreign weight\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n### Examples of ANCOVA in Nursing Research\n\n1.  **Patient Recovery Rates:** Comparing patient recovery rates across different treatment groups while controlling for age and baseline health status.\n2.  **Stress Reduction Programs:** Evaluating the effectiveness of stress reduction programs while controlling for initial stress levels.\n\n### Hands-on Example: Interpreting Your Results\n\n<a href=\"ancova_ex1.csv\" download>download ex. 1 data (CSV)</a>\n\n<details>\n\n<summary>JMP Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>Fit Model</code>.</li>\n\n<li>Select your categorical variable as the Model Effects and covariate as Continuous.</li>\n\n<li>Click <code>OK</code>.</li>\n\n<li>Click the red triangle and choose <code>Effect Tests</code> and <code>LSMeans Plot</code>.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>R Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        # Example ANCOVA in R\n        model <- lm(post_stress ~ group + pre_stress, data = data)\n        summary(model)\n        Anova(model, type = 3)\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Python Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n# Example ANCOVA in Python\nfrom statsmodels.formula.api import ols\nfrom statsmodels.stats.anova import anova_lm\nmodel = ols('post_stress ~ group + pre_stress', data=data).fit()\nprint(model.summary())\nprint(anova_lm(model, typ=3))\n        \n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>SPSS Instructions:</summary>\n\n<ul>\n\n<li>Go to <code>Analyze</code> \\> <code>General Linear Model</code> \\> <code>Univariate</code>.</li>\n\n<li>Select your categorical variable as the Fixed Factor and the covariate as Covariate.</li>\n\n<li>Click <code>OK</code> to generate the ANCOVA results.</li>\n\n</ul>\n\n</details>\n\n<details>\n\n<summary>Stata Code Example:</summary>\n\n<ul>\n\n<li>\n\n\n```{=html}\n<pre>\n        // Example ANCOVA in Stata\n        sysuse auto, clear\n        anova mpg foreign weight\n      </pre>\n```\n\n</li>\n\n</ul>\n\n</details>\n",
    "supporting": [
      "introduction-to-ancova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}